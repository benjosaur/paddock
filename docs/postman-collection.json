{
  "info": {
    "_postman_id": "8f6ccf7f-9c5d-4c5a-b456-1234567890ab",
    "name": "Paddock tRPC API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "Endpoints organized by router with success + validation tests. IDs are chained for follow-up calls. Set apiBase and authToken before running."
  },
  "variable": [
    { "key": "apiBase", "value": "http://localhost:3001" },
    { "key": "authToken", "value": "" }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "if (!pm.collectionVariables.get(\"uniq\")) { pm.collectionVariables.set(\"uniq\", Date.now().toString()); }",
          "if (!pm.collectionVariables.get(\"today\")) { pm.collectionVariables.set(\"today\", new Date().toISOString().slice(0, 10)); }"
        ]
      }
    }
  ],
  "item": [
    {
      "name": "Health",
      "request": {
        "method": "GET",
        "url": {
          "raw": "{{apiBase}}/health",
          "host": ["{{apiBase}}"],
          "path": ["health"]
        }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"status 200\", () => pm.response.code === 200);",
              "const json = pm.response.json();",
              "pm.test(\"has status ok\", () => json.status === \"ok\");"
            ]
          }
        }
      ]
    },
    {
      "name": "Clients",
      "item": [
        {
          "name": "clients.create (valid)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dateOfBirth\": \"1950-01-01\",\n  \"endDate\": \"open\",\n  \"details\": {\n    \"name\": \"Test Client {{uniq}}\",\n    \"customId\": \"TC-{{uniq}}\",\n    \"address\": {\n      \"streetAddress\": \"1 High St\",\n      \"locality\": \"Other\",\n      \"county\": \"Somerset\",\n      \"postCode\": \"TA41AA\",\n      \"deprivation\": { \"income\": false, \"health\": false }\n    },\n    \"donationScheme\": false,\n    \"donationAmount\": 0,\n    \"referredBy\": \"GP\",\n    \"clientAgreementDate\": \"2024-01-01\",\n    \"clientAgreementComments\": \"\",\n    \"riskAssessmentDate\": \"2024-01-01\",\n    \"riskAssessmentComments\": \"\",\n    \"services\": [\"Companionship\"],\n    \"attendsMag\": false,\n    \"notes\": [],\n    \"phone\": \"01234 567890\",\n    \"email\": \"client{{uniq}}@example.com\",\n    \"nextOfKin\": \"Next of Kin\",\n    \"attendanceAllowance\": {\n      \"requestedLevel\": \"Low\",\n      \"hoursToCompleteRequest\": 1,\n      \"completedBy\": { \"id\": \"\", \"name\": \"\" },\n      \"requestedDate\": \"2024-02-01\",\n      \"status\": \"Pending\",\n      \"confirmationDate\": \"\"\n    },\n    \"endReason\": \"None\"\n  },\n  \"requests\": []\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/clients.create",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "clients.create"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);",
                  "const json = pm.response.json();",
                  "pm.test(\"tRPC success\", () => json.result && !json.error);",
                  "const data = json.result?.data;",
                  "const cid = data?.clientId ?? data;",
                  "pm.test(\"clientId returned\", () => typeof cid === \"string\");",
                  "if (cid) pm.collectionVariables.set(\"clientId\", cid);"
                ]
              }
            }
          ]
        },
        {
          "name": "clients.create (invalid)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"dateOfBirth\": \"bad\", \"details\": { \"name\": 123 } }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/clients.create",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "clients.create"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"validation fails\", () => pm.response.code === 400 || !!json.error);"
                ]
              }
            }
          ]
        },
        {
          "name": "clients.getAll",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/clients.getAll",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "clients.getAll"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"status 200\", () => pm.response.code === 200);",
                  "pm.test(\"array\", () => Array.isArray(json.result?.data));"
                ]
              }
            }
          ]
        },
        {
          "name": "clients.getAllNotEndedYet",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/clients.getAllNotEndedYet",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "clients.getAllNotEndedYet"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "clients.getAllWithMagService",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/clients.getAllWithMagService",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "clients.getAllWithMagService"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "clients.getById",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/clients.getById?input={\"id\":\"{{clientId}}\"}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "clients.getById"],
              "query": [
                { "key": "input", "value": "{\"id\":\"{{clientId}}\"}" }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"status 200\", () => pm.response.code === 200);",
                  "pm.test(\"id matches\", () => json.result?.data?.id === pm.collectionVariables.get(\"clientId\"));"
                ]
              }
            }
          ]
        },
        {
          "name": "clients.update",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": \"{{clientId}}\",\n  \"dateOfBirth\": \"1950-01-01\",\n  \"endDate\": \"open\",\n  \"details\": {\n    \"name\": \"Test Client {{uniq}} Updated\",\n    \"customId\": \"TC-{{uniq}}-U\",\n    \"address\": {\n      \"streetAddress\": \"1 High St\",\n      \"locality\": \"Other\",\n      \"county\": \"Somerset\",\n      \"postCode\": \"TA41AA\",\n      \"deprivation\": { \"income\": false, \"health\": false }\n    },\n    \"donationScheme\": true,\n    \"donationAmount\": 10,\n    \"referredBy\": \"GP\",\n    \"clientAgreementDate\": \"2024-01-01\",\n    \"clientAgreementComments\": \"\",\n    \"riskAssessmentDate\": \"2024-01-01\",\n    \"riskAssessmentComments\": \"\",\n    \"services\": [\"Companionship\"],\n    \"attendsMag\": false,\n    \"notes\": [],\n    \"phone\": \"01234 567890\",\n    \"email\": \"client{{uniq}}@example.com\",\n    \"nextOfKin\": \"Next of Kin\",\n    \"attendanceAllowance\": {\n      \"requestedLevel\": \"Low\",\n      \"hoursToCompleteRequest\": 1,\n      \"completedBy\": { \"id\": \"\", \"name\": \"\" },\n      \"requestedDate\": \"2024-02-01\",\n      \"status\": \"Pending\",\n      \"confirmationDate\": \"\"\n    },\n    \"endReason\": \"None\"\n  },\n  \"requests\": []\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/clients.update",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "clients.update"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "clients.updateName",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"client\": { \"id\": \"{{clientId}}\" }, \"newName\": \"Renamed Client {{uniq}}\" }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/clients.updateName",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "clients.updateName"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "clients.updateCustomId",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"client\": { \"id\": \"{{clientId}}\" }, \"newCustomId\": \"TC-{{uniq}}-NEW\" }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/clients.updateCustomId",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "clients.updateCustomId"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "clients.updatePostCode",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"client\": { \"id\": \"{{clientId}}\" }, \"newPostcode\": \"TA41AB\" }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/clients.updatePostCode",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "clients.updatePostCode"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "clients.createInfoEntry",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"client\": {\n    \"id\": \"{{clientId}}\",\n    \"dateOfBirth\": \"1950-01-01\",\n    \"endDate\": \"open\",\n    \"details\": {\n      \"name\": \"Test Client {{uniq}}\",\n      \"customId\": \"TC-{{uniq}}\",\n      \"address\": {\n        \"streetAddress\": \"1 High St\",\n        \"locality\": \"Other\",\n        \"county\": \"Somerset\",\n        \"postCode\": \"TA41AA\",\n        \"deprivation\": { \"income\": false, \"health\": false }\n      },\n      \"donationScheme\": false,\n      \"donationAmount\": 0,\n      \"referredBy\": \"GP\",\n      \"clientAgreementDate\": \"2024-01-01\",\n      \"clientAgreementComments\": \"\",\n      \"riskAssessmentDate\": \"2024-01-01\",\n      \"riskAssessmentComments\": \"\",\n      \"services\": [\"Information\"],\n      \"attendsMag\": false,\n      \"notes\": [],\n      \"phone\": \"01234 567890\",\n      \"email\": \"client{{uniq}}@example.com\",\n      \"nextOfKin\": \"Next of Kin\",\n      \"attendanceAllowance\": {\n        \"requestedLevel\": \"Low\",\n        \"hoursToCompleteRequest\": 1,\n        \"completedBy\": { \"id\": \"\", \"name\": \"\" },\n        \"requestedDate\": \"2024-02-01\",\n        \"status\": \"Pending\",\n        \"confirmationDate\": \"\"\n      },\n      \"endReason\": \"None\"\n    },\n    \"requests\": []\n  },\n  \"infoDetails\": {\n    \"completedBy\": { \"id\": \"{{volunteerId}}\", \"name\": \"Volunteer\" },\n    \"date\": \"2024-05-01\",\n    \"note\": \"Info visit\",\n    \"services\": [\"Information\"],\n    \"minutesTaken\": 60,\n    \"source\": \"Phone\"\n  }\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/clients.createInfoEntry",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "clients.createInfoEntry"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "clients.end",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"personId\": \"{{clientId}}\", \"endDate\": \"{{today}}\", \"endReason\": \"No Longer Required\" }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/clients.end",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "clients.end"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "clients.delete",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"id\": \"{{clientId}}\" }" },
            "url": {
              "raw": "{{apiBase}}/trpc/clients.delete",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "clients.delete"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Requests",
      "item": [
        {
          "name": "requests.create (valid)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"requestType\": \"paid\",\n  \"clientId\": \"{{clientId}}\",\n  \"startDate\": \"2024-03-01\",\n  \"endDate\": \"open\",\n  \"details\": {\n    \"customId\": \"REQ-{{uniq}}\",\n    \"name\": \"Test Client {{uniq}}\",\n    \"weeklyHours\": 5,\n    \"oneOffStartDateHours\": 1,\n    \"address\": {\n      \"streetAddress\": \"1 High St\",\n      \"locality\": \"Other\",\n      \"county\": \"Somerset\",\n      \"postCode\": \"TA41AA\",\n      \"deprivation\": { \"income\": false, \"health\": false }\n    },\n    \"status\": \"normal\",\n    \"services\": [\"Companionship\"],\n    \"notes\": \"Request notes\"\n  }\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/requests.create",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "requests.create"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"status 200\", () => pm.response.code === 200);",
                  "const rid = json.result?.data;",
                  "pm.test(\"requestId returned\", () => typeof rid === \"string\");",
                  "if (rid) pm.collectionVariables.set(\"requestId\", rid);"
                ]
              }
            }
          ]
        },
        {
          "name": "requests.create (invalid)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"requestType\": \"paid\", \"clientId\": \"{{clientId}}\", \"details\": {} }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/requests.create",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "requests.create"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"validation fails\", () => pm.response.code === 400 || !!json.error);"
                ]
              }
            }
          ]
        },
        {
          "name": "requests.getAllWithoutInfoWithPackages",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/requests.getAllWithoutInfoWithPackages",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "requests.getAllWithoutInfoWithPackages"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "requests.getAllWithoutInfoNotEndedYetWithPackages",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/requests.getAllWithoutInfoNotEndedYetWithPackages",
              "host": ["{{apiBase}}"],
              "path": [
                "trpc",
                "requests.getAllWithoutInfoNotEndedYetWithPackages"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "requests.getAllInfoMetadata",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/requests.getAllInfoMetadata",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "requests.getAllInfoMetadata"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "requests.getAllMetadataWithoutInfo",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/requests.getAllMetadataWithoutInfo",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "requests.getAllMetadataWithoutInfo"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "requests.getAllMetadataWithoutInfoNotEndedYet",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/requests.getAllMetadataWithoutInfoNotEndedYet",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "requests.getAllMetadataWithoutInfoNotEndedYet"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "requests.getById",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/requests.getById?input={\"id\":\"{{requestId}}\"}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "requests.getById"],
              "query": [
                { "key": "input", "value": "{\"id\":\"{{requestId}}\"}" }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"status 200\", () => pm.response.code === 200);",
                  "pm.test(\"id matches\", () => json.result?.data?.id === pm.collectionVariables.get(\"requestId\"));"
                ]
              }
            }
          ]
        },
        {
          "name": "requests.getRequestWithOnePackageByPackageId",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/requests.getRequestWithOnePackageByPackageId?input={\"packageId\":\"{{packageId}}\"}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "requests.getRequestWithOnePackageByPackageId"],
              "query": [
                { "key": "input", "value": "{\"packageId\":\"{{packageId}}\"}" }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "requests.update",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": \"{{requestId}}\",\n  \"requestType\": \"paid\",\n  \"clientId\": \"{{clientId}}\",\n  \"startDate\": \"2024-03-01\",\n  \"endDate\": \"open\",\n  \"details\": {\n    \"customId\": \"REQ-{{uniq}}-U\",\n    \"name\": \"Test Client {{uniq}}\",\n    \"weeklyHours\": 6,\n    \"oneOffStartDateHours\": 1,\n    \"address\": {\n      \"streetAddress\": \"1 High St\",\n      \"locality\": \"Other\",\n      \"county\": \"Somerset\",\n      \"postCode\": \"TA41AA\",\n      \"deprivation\": { \"income\": false, \"health\": false }\n    },\n    \"status\": \"urgent\",\n    \"services\": [\"Companionship\"],\n    \"notes\": \"Request update\"\n  }\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/requests.update",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "requests.update"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "requests.renew",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"oldRequest\": {\n    \"id\": \"{{requestId}}\",\n    \"requestType\": \"paid\",\n    \"clientId\": \"{{clientId}}\",\n    \"startDate\": \"2024-03-01\",\n    \"endDate\": \"open\",\n    \"details\": {\n      \"customId\": \"REQ-{{uniq}}\",\n      \"name\": \"Test Client {{uniq}}\",\n      \"weeklyHours\": 5,\n      \"oneOffStartDateHours\": 1,\n      \"address\": {\n        \"streetAddress\": \"1 High St\",\n        \"locality\": \"Other\",\n        \"county\": \"Somerset\",\n        \"postCode\": \"TA41AA\",\n        \"deprivation\": { \"income\": false, \"health\": false }\n      },\n      \"status\": \"normal\",\n      \"services\": [\"Companionship\"],\n      \"notes\": \"Request notes\"\n    }\n  },\n  \"newRequest\": {\n    \"requestType\": \"paid\",\n    \"clientId\": \"{{clientId}}\",\n    \"startDate\": \"2025-01-01\",\n    \"endDate\": \"open\",\n    \"details\": {\n      \"customId\": \"REQ-{{uniq}}-NEW\",\n      \"name\": \"Test Client {{uniq}}\",\n      \"weeklyHours\": 4,\n      \"oneOffStartDateHours\": 0,\n      \"address\": {\n        \"streetAddress\": \"1 High St\",\n        \"locality\": \"Other\",\n        \"county\": \"Somerset\",\n        \"postCode\": \"TA41AA\",\n        \"deprivation\": { \"income\": false, \"health\": false }\n      },\n      \"status\": \"normal\",\n      \"services\": [\"Companionship\"],\n      \"notes\": \"Renewed\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/requests.renew",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "requests.renew"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "requests.endRequestAndPackages",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"requestId\": \"{{requestId}}\", \"endDate\": \"{{today}}\" }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/requests.endRequestAndPackages",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "requests.endRequestAndPackages"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "requests.delete",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"id\": \"{{requestId}}\" }" },
            "url": {
              "raw": "{{apiBase}}/trpc/requests.delete",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "requests.delete"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Volunteers",
      "item": [
        {
          "name": "volunteers.create (valid)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dateOfBirth\": \"1985-05-05\",\n  \"endDate\": \"open\",\n  \"dbsExpiry\": \"2025-05-05\",\n  \"publicLiabilityExpiry\": \"2025-06-01\",\n  \"trainingRecords\": [],\n  \"details\": {\n    \"name\": \"Test Volunteer {{uniq}}\",\n    \"address\": {\n      \"streetAddress\": \"2 High St\",\n      \"locality\": \"Other\",\n      \"county\": \"Somerset\",\n      \"postCode\": \"TA41AB\",\n      \"deprivation\": { \"income\": false, \"health\": false }\n    },\n    \"phone\": \"01234 111111\",\n    \"email\": \"vol{{uniq}}@example.com\",\n    \"nextOfKin\": \"NK\",\n    \"services\": [\"MAG\"],\n    \"attendsMag\": true,\n    \"notes\": [],\n    \"capacity\": \"Part-time\",\n    \"dbsNumber\": \"DBS-{{uniq}}\",\n    \"publicLiabilityNumber\": \"PL-{{uniq}}\",\n    \"startDate\": \"2024-01-01\",\n    \"role\": \"Volunteer\"\n  },\n  \"packages\": []\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/volunteers.create",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "volunteers.create"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"status 200\", () => pm.response.code === 200);",
                  "const vid = json.result?.data;",
                  "pm.test(\"volunteerId returned\", () => typeof vid === \"string\");",
                  "if (vid) pm.collectionVariables.set(\"volunteerId\", vid);"
                ]
              }
            }
          ]
        },
        {
          "name": "volunteers.create (invalid)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"dateOfBirth\": \"1980-01-01\", \"details\": { \"name\": \"Bad\", \"role\": \"NotARole\" } }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/volunteers.create",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "volunteers.create"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"validation fails\", () => pm.response.code === 400 || !!json.error);"
                ]
              }
            }
          ]
        },
        {
          "name": "volunteers.getAll",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/volunteers.getAll",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "volunteers.getAll"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "volunteers.getAllNotEndedYet",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/volunteers.getAllNotEndedYet",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "volunteers.getAllNotEndedYet"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "volunteers.getById",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/volunteers.getById?input={\"id\":\"{{volunteerId}}\"}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "volunteers.getById"],
              "query": [
                { "key": "input", "value": "{\"id\":\"{{volunteerId}}\"}" }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "volunteers.getCoreTrainingRecordCompletions",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/volunteers.getCoreTrainingRecordCompletions?input={\"withEnded\":false}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "volunteers.getCoreTrainingRecordCompletions"],
              "query": [{ "key": "input", "value": "{\"withEnded\":false}" }]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "volunteers.create -> getAllPackagesByCoordinator",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/volunteers.getAllPackagesByCoordinator",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "volunteers.getAllPackagesByCoordinator"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "volunteers.update",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": \"{{volunteerId}}\",\n  \"dateOfBirth\": \"1985-05-05\",\n  \"endDate\": \"open\",\n  \"dbsExpiry\": \"2025-05-05\",\n  \"publicLiabilityExpiry\": \"2025-06-01\",\n  \"trainingRecords\": [],\n  \"details\": {\n    \"name\": \"Test Volunteer {{uniq}} Updated\",\n    \"address\": {\n      \"streetAddress\": \"2 High St\",\n      \"locality\": \"Other\",\n      \"county\": \"Somerset\",\n      \"postCode\": \"TA41AB\",\n      \"deprivation\": { \"income\": false, \"health\": false }\n    },\n    \"phone\": \"01234 111111\",\n    \"email\": \"vol{{uniq}}@example.com\",\n    \"nextOfKin\": \"NK\",\n    \"services\": [\"MAG\"],\n    \"attendsMag\": true,\n    \"notes\": [],\n    \"capacity\": \"Part-time\",\n    \"dbsNumber\": \"DBS-{{uniq}}\",\n    \"publicLiabilityNumber\": \"PL-{{uniq}}\",\n    \"startDate\": \"2024-01-01\",\n    \"role\": \"Volunteer\"\n  },\n  \"packages\": []\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/volunteers.update",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "volunteers.update"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "volunteers.updateName",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"volunteer\": { \"id\": \"{{volunteerId}}\" }, \"newName\": \"Volunteer {{uniq}} Renamed\" }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/volunteers.updateName",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "volunteers.updateName"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "volunteers.end",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"personId\": \"{{volunteerId}}\", \"endDate\": \"{{today}}\", \"endReason\": \"No Longer Required\" }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/volunteers.end",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "volunteers.end"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "volunteers.delete",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"id\": \"{{volunteerId}}\" }" },
            "url": {
              "raw": "{{apiBase}}/trpc/volunteers.delete",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "volunteers.delete"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Mps",
      "item": [
        {
          "name": "mps.create (valid)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"dateOfBirth\": \"1975-02-02\",\n  \"endDate\": \"open\",\n  \"dbsExpiry\": \"2025-05-05\",\n  \"publicLiabilityExpiry\": \"2025-06-01\",\n  \"trainingRecords\": [],\n  \"details\": {\n    \"name\": \"Test MP {{uniq}}\",\n    \"address\": {\n      \"streetAddress\": \"3 High St\",\n      \"locality\": \"Other\",\n      \"county\": \"Somerset\",\n      \"postCode\": \"TA41AC\",\n      \"deprivation\": { \"income\": false, \"health\": false }\n    },\n    \"phone\": \"01234 222222\",\n    \"email\": \"mp{{uniq}}@example.com\",\n    \"nextOfKin\": \"NK\",\n    \"services\": [\"MAG\"],\n    \"attendsMag\": false,\n    \"notes\": [],\n    \"capacity\": \"Full-time\",\n    \"dbsNumber\": \"DBS-MP-{{uniq}}\",\n    \"publicLiabilityNumber\": \"PL-MP-{{uniq}}\",\n    \"startDate\": \"2024-01-01\"\n  },\n  \"packages\": []\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/mps.create",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mps.create"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"status 200\", () => pm.response.code === 200);",
                  "const mid = json.result?.data;",
                  "pm.test(\"mpId returned\", () => typeof mid === \"string\");",
                  "if (mid) pm.collectionVariables.set(\"mpId\", mid);"
                ]
              }
            }
          ]
        },
        {
          "name": "mps.create (invalid)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"dateOfBirth\": \"1970\", \"details\": { \"name\": 1 } }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/mps.create",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mps.create"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"validation fails\", () => pm.response.code === 400 || !!pm.response.json().error);"
                ]
              }
            }
          ]
        },
        {
          "name": "mps.getAll",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/mps.getAll",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mps.getAll"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "mps.getAllNotEndedYet",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/mps.getAllNotEndedYet",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mps.getAllNotEndedYet"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "mps.getById",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/mps.getById?input={\"id\":\"{{mpId}}\"}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mps.getById"],
              "query": [{ "key": "input", "value": "{\"id\":\"{{mpId}}\"}" }]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "mps.getCoreTrainingRecordCompletions",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/mps.getCoreTrainingRecordCompletions?input={\"withEnded\":false}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mps.getCoreTrainingRecordCompletions"],
              "query": [{ "key": "input", "value": "{\"withEnded\":false}" }]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "mps.update",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": \"{{mpId}}\",\n  \"dateOfBirth\": \"1975-02-02\",\n  \"endDate\": \"open\",\n  \"dbsExpiry\": \"2025-05-05\",\n  \"publicLiabilityExpiry\": \"2025-06-01\",\n  \"trainingRecords\": [],\n  \"details\": {\n    \"name\": \"Test MP {{uniq}} Updated\",\n    \"address\": {\n      \"streetAddress\": \"3 High St\",\n      \"locality\": \"Other\",\n      \"county\": \"Somerset\",\n      \"postCode\": \"TA41AC\",\n      \"deprivation\": { \"income\": false, \"health\": false }\n    },\n    \"phone\": \"01234 222222\",\n    \"email\": \"mp{{uniq}}@example.com\",\n    \"nextOfKin\": \"NK\",\n    \"services\": [\"MAG\"],\n    \"attendsMag\": false,\n    \"notes\": [],\n    \"capacity\": \"Full-time\",\n    \"dbsNumber\": \"DBS-MP-{{uniq}}\",\n    \"publicLiabilityNumber\": \"PL-MP-{{uniq}}\",\n    \"startDate\": \"2024-01-01\"\n  },\n  \"packages\": []\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/mps.update",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mps.update"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "mps.updateName",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"mp\": { \"id\": \"{{mpId}}\" }, \"newName\": \"MP {{uniq}} Renamed\" }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/mps.updateName",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mps.updateName"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "mps.end",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"personId\": \"{{mpId}}\", \"endDate\": \"{{today}}\", \"endReason\": \"No Longer Required\" }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/mps.end",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mps.end"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "mps.delete",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"id\": \"{{mpId}}\" }" },
            "url": {
              "raw": "{{apiBase}}/trpc/mps.delete",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mps.delete"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Packages",
      "item": [
        {
          "name": "packages.create (valid)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"carerId\": \"{{volunteerId}}\",\n  \"requestId\": \"{{requestId}}\",\n  \"startDate\": \"2024-03-10\",\n  \"endDate\": \"open\",\n  \"details\": {\n    \"name\": \"Test Volunteer {{uniq}}\",\n    \"weeklyHours\": 4,\n    \"oneOffStartDateHours\": 0,\n    \"address\": {\n      \"streetAddress\": \"2 High St\",\n      \"locality\": \"Other\",\n      \"county\": \"Somerset\",\n      \"postCode\": \"TA41AB\",\n      \"deprivation\": { \"income\": false, \"health\": false }\n    },\n    \"notes\": \"Package notes\",\n    \"services\": [\"Companionship\"]\n  }\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/packages.create",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "packages.create"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"status 200\", () => pm.response.code === 200);",
                  "const pid = json.result?.data;",
                  "pm.test(\"packageId returned\", () => typeof pid === \"string\");",
                  "if (pid) pm.collectionVariables.set(\"packageId\", pid);"
                ]
              }
            }
          ]
        },
        {
          "name": "packages.create (invalid)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"requestId\": \"{{requestId}}\", \"startDate\": \"bad\", \"details\": { \"name\": \"X\" } }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/packages.create",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "packages.create"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"validation fails\", () => pm.response.code === 400 || !!pm.response.json().error);"
                ]
              }
            }
          ]
        },
        {
          "name": "packages.createSole",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"carerId\": \"{{volunteerId}}\",\n  \"startDate\": \"2024-03-15\",\n  \"endDate\": \"open\",\n  \"details\": {\n    \"name\": \"Sole Volunteer {{uniq}}\",\n    \"weeklyHours\": 2,\n    \"oneOffStartDateHours\": 0,\n    \"notes\": \"Sole package\",\n    \"services\": [\"MAG\"]\n  }\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/packages.createSole",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "packages.createSole"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"status 200\", () => pm.response.code === 200);",
                  "const spid = json.result?.data;",
                  "pm.test(\"sole package id returned\", () => typeof spid === \"string\");",
                  "if (spid) pm.collectionVariables.set(\"solePackageId\", spid);"
                ]
              }
            }
          ]
        },
        {
          "name": "packages.getAll",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/packages.getAll",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "packages.getAll"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "packages.getAllWithoutInfoNotEndedYet",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/packages.getAllWithoutInfoNotEndedYet",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "packages.getAllWithoutInfoNotEndedYet"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "packages.getAllInfo",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/packages.getAllInfo",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "packages.getAllInfo"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "packages.getAllWithoutInfo",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/packages.getAllWithoutInfo",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "packages.getAllWithoutInfo"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "packages.getById",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/packages.getById?input={\"id\":\"{{packageId}}\"}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "packages.getById"],
              "query": [
                { "key": "input", "value": "{\"id\":\"{{packageId}}\"}" }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"status 200\", () => pm.response.code === 200);",
                  "pm.collectionVariables.set(\"packageObj\", JSON.stringify(json.result?.data));"
                ]
              }
            }
          ]
        },
        {
          "name": "packages.update",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": \"{{packageId}}\",\n  \"carerId\": \"{{volunteerId}}\",\n  \"requestId\": \"{{requestId}}\",\n  \"startDate\": \"2024-03-10\",\n  \"endDate\": \"open\",\n  \"details\": {\n    \"name\": \"Test Volunteer {{uniq}}\",\n    \"weeklyHours\": 6,\n    \"oneOffStartDateHours\": 0,\n    \"address\": {\n      \"streetAddress\": \"2 High St\",\n      \"locality\": \"Other\",\n      \"county\": \"Somerset\",\n      \"postCode\": \"TA41AB\",\n      \"deprivation\": { \"income\": false, \"health\": false }\n    },\n    \"notes\": \"Package update\",\n    \"services\": [\"Companionship\"]\n  }\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/packages.update",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "packages.update"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "packages.renew",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"oldPackage\": {\n    \"id\": \"{{packageId}}\",\n    \"carerId\": \"{{volunteerId}}\",\n    \"requestId\": \"{{requestId}}\",\n    \"startDate\": \"2024-03-10\",\n    \"endDate\": \"open\",\n    \"details\": {\n      \"name\": \"Test Volunteer {{uniq}}\",\n      \"weeklyHours\": 6,\n      \"oneOffStartDateHours\": 0,\n      \"address\": {\n        \"streetAddress\": \"2 High St\",\n        \"locality\": \"Other\",\n        \"county\": \"Somerset\",\n        \"postCode\": \"TA41AB\",\n        \"deprivation\": { \"income\": false, \"health\": false }\n      },\n      \"notes\": \"Package update\",\n      \"services\": [\"Companionship\"]\n    }\n  },\n  \"newPackage\": {\n    \"carerId\": \"{{volunteerId}}\",\n    \"requestId\": \"{{requestId}}\",\n    \"startDate\": \"2025-01-01\",\n    \"endDate\": \"open\",\n    \"details\": {\n      \"name\": \"Test Volunteer {{uniq}}\",\n      \"weeklyHours\": 4,\n      \"oneOffStartDateHours\": 0,\n      \"address\": {\n        \"streetAddress\": \"2 High St\",\n        \"locality\": \"Other\",\n        \"county\": \"Somerset\",\n        \"postCode\": \"TA41AB\",\n        \"deprivation\": { \"income\": false, \"health\": false }\n      },\n      \"notes\": \"Package renew\",\n      \"services\": [\"Companionship\"]\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/packages.renew",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "packages.renew"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "packages.addCoverPeriod",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"oldPackage\": {\n    \"id\": \"{{packageId}}\",\n    \"carerId\": \"{{volunteerId}}\",\n    \"requestId\": \"{{requestId}}\",\n    \"startDate\": \"2024-03-10\",\n    \"endDate\": \"open\",\n    \"details\": {\n      \"name\": \"Test Volunteer {{uniq}}\",\n      \"weeklyHours\": 6,\n      \"oneOffStartDateHours\": 0,\n      \"address\": {\n        \"streetAddress\": \"2 High St\",\n        \"locality\": \"Other\",\n        \"county\": \"Somerset\",\n        \"postCode\": \"TA41AB\",\n        \"deprivation\": { \"income\": false, \"health\": false }\n      },\n      \"notes\": \"Package update\",\n      \"services\": [\"Companionship\"]\n    }\n  },\n  \"coverDetails\": {\n    \"carerId\": \"{{volunteerId}}\",\n    \"startDate\": \"2024-06-01\",\n    \"endDate\": \"2024-06-15\",\n    \"oneOffStartDateHours\": 1\n  }\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/packages.addCoverPeriod",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "packages.addCoverPeriod"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "packages.end",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"packageId\": \"{{packageId}}\", \"endDate\": \"{{today}}\" }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/packages.end",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "packages.end"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "packages.delete",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"id\": \"{{packageId}}\" }" },
            "url": {
              "raw": "{{apiBase}}/trpc/packages.delete",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "packages.delete"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "TrainingRecords",
      "item": [
        {
          "name": "trainingRecords.create (valid)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"ownerId\": \"{{volunteerId}}\",\n  \"completionDate\": \"2024-04-01\",\n  \"expiryDate\": \"2025-04-01\",\n  \"endDate\": \"open\",\n  \"details\": {\n    \"name\": \"Core Training\",\n    \"recordName\": \"First Aid Skills\",\n    \"recordNumber\": \"TR-{{uniq}}\",\n    \"notes\": \"Completed\"\n  }\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/trainingRecords.create",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "trainingRecords.create"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"status 200\", () => pm.response.code === 200);",
                  "const tid = json.result?.data;",
                  "pm.test(\"training record id returned\", () => typeof tid === \"string\");",
                  "if (tid) pm.collectionVariables.set(\"trainingRecordId\", tid);"
                ]
              }
            }
          ]
        },
        {
          "name": "trainingRecords.create (invalid)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"ownerId\": \"{{volunteerId}}\", \"completionDate\": \"bad-date\", \"details\": { \"name\": \"x\", \"recordName\": \"First Aid Skills\" } }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/trainingRecords.create",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "trainingRecords.create"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"validation fails\", () => pm.response.code === 400 || !!pm.response.json().error);"
                ]
              }
            }
          ]
        },
        {
          "name": "trainingRecords.getAll",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/trainingRecords.getAll",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "trainingRecords.getAll"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "trainingRecords.getAllNotEndedYet",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/trainingRecords.getAllNotEndedYet",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "trainingRecords.getAllNotEndedYet"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "trainingRecords.getByExpiringBefore",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/trainingRecords.getByExpiringBefore?input={\"expiryDate\":\"2025-06-01\"}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "trainingRecords.getByExpiringBefore"],
              "query": [
                { "key": "input", "value": "{\"expiryDate\":\"2025-06-01\"}" }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "trainingRecords.getById",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/trainingRecords.getById?input={\"id\":\"{{trainingRecordId}}\",\"ownerId\":\"{{volunteerId}}\"}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "trainingRecords.getById"],
              "query": [
                {
                  "key": "input",
                  "value": "{\"id\":\"{{trainingRecordId}}\",\"ownerId\":\"{{volunteerId}}\"}"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "trainingRecords.update",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": \"{{trainingRecordId}}\",\n  \"ownerId\": \"{{volunteerId}}\",\n  \"completionDate\": \"2024-04-01\",\n  \"expiryDate\": \"2025-04-01\",\n  \"endDate\": \"open\",\n  \"details\": {\n    \"name\": \"Core Training Updated\",\n    \"recordName\": \"First Aid Skills\",\n    \"recordNumber\": \"TR-{{uniq}}\",\n    \"notes\": \"Updated\"\n  }\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/trainingRecords.update",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "trainingRecords.update"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "trainingRecords.end",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"ownerId\": \"{{volunteerId}}\", \"recordId\": \"{{trainingRecordId}}\", \"endDate\": \"{{today}}\" }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/trainingRecords.end",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "trainingRecords.end"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "trainingRecords.delete",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"id\": \"{{trainingRecordId}}\", \"ownerId\": \"{{volunteerId}}\" }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/trainingRecords.delete",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "trainingRecords.delete"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Mag",
      "item": [
        {
          "name": "mag.create (valid)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"date\": \"2024-04-15\",\n  \"totalHours\": 2,\n  \"clients\": [\n    {\n      \"id\": \"{{clientId}}\",\n      \"details\": {\n        \"name\": \"Test Client {{uniq}}\",\n        \"address\": {\n          \"streetAddress\": \"1 High St\",\n          \"locality\": \"Other\",\n          \"county\": \"Somerset\",\n          \"postCode\": \"TA41AA\",\n          \"deprivation\": { \"income\": false, \"health\": false }\n        }\n      }\n    }\n  ],\n  \"mps\": [\n    { \"id\": \"{{mpId}}\", \"details\": { \"name\": \"MP {{uniq}}\" } }\n  ],\n  \"volunteers\": [\n    { \"id\": \"{{volunteerId}}\", \"details\": { \"name\": \"Test Volunteer {{uniq}}\" } }\n  ],\n  \"details\": {\n    \"totalClients\": 1,\n    \"totalFamily\": 0,\n    \"totalVolunteers\": 1,\n    \"totalMps\": 1,\n    \"otherAttendees\": 0,\n    \"notes\": \"MAG session\"\n  }\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/mag.create",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mag.create"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"status 200\", () => pm.response.code === 200);",
                  "const mid = json.result?.data;",
                  "pm.test(\"mag id returned\", () => typeof mid === \"string\");",
                  "if (mid) pm.collectionVariables.set(\"magId\", mid);"
                ]
              }
            }
          ]
        },
        {
          "name": "mag.create (invalid)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"totalHours\": 1, \"clients\": [] }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/mag.create",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mag.create"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"validation fails\", () => pm.response.code === 400 || !!pm.response.json().error);"
                ]
              }
            }
          ]
        },
        {
          "name": "mag.getAll",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/mag.getAll",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mag.getAll"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "mag.getById",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/mag.getById?input={\"id\":\"{{magId}}\"}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mag.getById"],
              "query": [{ "key": "input", "value": "{\"id\":\"{{magId}}\"}" }]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "mag.getByDateInterval",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/mag.getByDateInterval?input={\"startDate\":\"2024-01-01\",\"endDate\":\"2024-12-31\"}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mag.getByDateInterval"],
              "query": [
                {
                  "key": "input",
                  "value": "{\"startDate\":\"2024-01-01\",\"endDate\":\"2024-12-31\"}"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "mag.update",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": \"{{magId}}\",\n  \"date\": \"2024-04-15\",\n  \"totalHours\": 3,\n  \"clients\": [\n    {\n      \"id\": \"{{clientId}}\",\n      \"details\": {\n        \"name\": \"Test Client {{uniq}}\",\n        \"address\": {\n          \"streetAddress\": \"1 High St\",\n          \"locality\": \"Other\",\n          \"county\": \"Somerset\",\n          \"postCode\": \"TA41AA\",\n          \"deprivation\": { \"income\": false, \"health\": false }\n        }\n      }\n    }\n  ],\n  \"mps\": [ { \"id\": \"{{mpId}}\", \"details\": { \"name\": \"MP {{uniq}}\" } } ],\n  \"volunteers\": [ { \"id\": \"{{volunteerId}}\", \"details\": { \"name\": \"Test Volunteer {{uniq}}\" } } ],\n  \"details\": {\n    \"totalClients\": 1,\n    \"totalFamily\": 0,\n    \"totalVolunteers\": 1,\n    \"totalMps\": 1,\n    \"otherAttendees\": 0,\n    \"notes\": \"MAG session updated\"\n  }\n}"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/mag.update",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mag.update"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "mag.delete",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"id\": \"{{magId}}\" }" },
            "url": {
              "raw": "{{apiBase}}/trpc/mag.delete",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mag.delete"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Analytics",
      "item": [
        {
          "name": "analytics.generateAttendanceAllowanceCrossSection",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/analytics.generateAttendanceAllowanceCrossSection",
              "host": ["{{apiBase}}"],
              "path": [
                "trpc",
                "analytics.generateAttendanceAllowanceCrossSection"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "analytics.generateAttendanceAllowanceReport",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/analytics.generateAttendanceAllowanceReport?input={\"startYear\":2020}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "analytics.generateAttendanceAllowanceReport"],
              "query": [{ "key": "input", "value": "{\"startYear\":2020}" }]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "analytics.generateCoordinatorAttendanceReport",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/analytics.generateCoordinatorAttendanceReport?input={\"startYear\":2020}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "analytics.generateCoordinatorAttendanceReport"],
              "query": [{ "key": "input", "value": "{\"startYear\":2020}" }]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "analytics.getActiveRequestsCrossSection",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/analytics.getActiveRequestsCrossSection",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "analytics.getActiveRequestsCrossSection"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "analytics.getActivePackagesCrossSection",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/analytics.getActivePackagesCrossSection",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "analytics.getActivePackagesCrossSection"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "analytics.getRequestsReport",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/analytics.getRequestsReport?input={\"isInfo\":false,\"startYear\":2020}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "analytics.getRequestsReport"],
              "query": [
                {
                  "key": "input",
                  "value": "{\"isInfo\":false,\"startYear\":2020}"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "analytics.getPackagesReport",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/analytics.getPackagesReport?input={\"startYear\":2020}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "analytics.getPackagesReport"],
              "query": [{ "key": "input", "value": "{\"startYear\":2020}" }]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "analytics.generateCoordinatorPackagesReport",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/analytics.generateCoordinatorPackagesReport?input={\"startYear\":2020}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "analytics.generateCoordinatorPackagesReport"],
              "query": [{ "key": "input", "value": "{\"startYear\":2020}" }]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "analytics.getActiveRequestsDeprivationCrossSection",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/analytics.getActiveRequestsDeprivationCrossSection",
              "host": ["{{apiBase}}"],
              "path": [
                "trpc",
                "analytics.getActiveRequestsDeprivationCrossSection"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "analytics.getActivePackagesDeprivationCrossSection",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/analytics.getActivePackagesDeprivationCrossSection",
              "host": ["{{apiBase}}"],
              "path": [
                "trpc",
                "analytics.getActivePackagesDeprivationCrossSection"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "analytics.getRequestsDeprivationReport",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/analytics.getRequestsDeprivationReport?input={\"isInfo\":false,\"startYear\":2020}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "analytics.getRequestsDeprivationReport"],
              "query": [
                {
                  "key": "input",
                  "value": "{\"isInfo\":false,\"startYear\":2020}"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "analytics.getPackagesDeprivationReport",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" }
            ],
            "url": {
              "raw": "{{apiBase}}/trpc/analytics.getPackagesDeprivationReport?input={\"startYear\":2020}",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "analytics.getPackagesDeprivationReport"],
              "query": [{ "key": "input", "value": "{\"startYear\":2020}" }]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Cleanup",
      "item": [
        {
          "name": "trainingRecords.delete",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"id\": \"{{trainingRecordId}}\", \"ownerId\": \"{{volunteerId}}\" }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/trainingRecords.delete",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "trainingRecords.delete"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "packages.delete",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"id\": \"{{packageId}}\" }" },
            "url": {
              "raw": "{{apiBase}}/trpc/packages.delete",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "packages.delete"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "packages.delete (sole)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{ \"id\": \"{{solePackageId}}\" }"
            },
            "url": {
              "raw": "{{apiBase}}/trpc/packages.delete",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "packages.delete"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "requests.delete",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"id\": \"{{requestId}}\" }" },
            "url": {
              "raw": "{{apiBase}}/trpc/requests.delete",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "requests.delete"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "clients.delete",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"id\": \"{{clientId}}\" }" },
            "url": {
              "raw": "{{apiBase}}/trpc/clients.delete",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "clients.delete"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "volunteers.delete",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"id\": \"{{volunteerId}}\" }" },
            "url": {
              "raw": "{{apiBase}}/trpc/volunteers.delete",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "volunteers.delete"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "mps.delete",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"id\": \"{{mpId}}\" }" },
            "url": {
              "raw": "{{apiBase}}/trpc/mps.delete",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mps.delete"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        },
        {
          "name": "mag.delete",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{authToken}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": { "mode": "raw", "raw": "{ \"id\": \"{{magId}}\" }" },
            "url": {
              "raw": "{{apiBase}}/trpc/mag.delete",
              "host": ["{{apiBase}}"],
              "path": ["trpc", "mag.delete"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test(\"status 200\", () => pm.response.code === 200);"
                ]
              }
            }
          ]
        }
      ]
    }
  ]
}
